# 🎵 自動廣播系統 (RadioOne)

> 一個簡單易用的定時音訊播放工具，專為學校、機關、商店等需要定時廣播的場所設計

**開發者**：李孟一（僑務委員會外交替代役）  
**聯絡方式**：LINE ID: `dreamone09`  
**GitHub**：https://github.com/DreamOne09/radioone

---

## 📖 這是什麼？

這是一個**免安裝、免設定**的自動廣播系統，讓您可以：
- ⏰ 設定每週固定時間自動播放音樂或廣播
- 📂 輕鬆管理多個播放排程
- 🔔 播放時自動彈出通知提醒
- 💾 所有設定自動保存，重開機也不會遺失
- 🖥️ 支援 Windows 7、Windows 8、Windows 10、Windows 11，甚至 Windows Server 2008

**適用場景**：
- 學校上下課鐘聲
- 辦公室定時廣播
- 商店營業音樂
- 工廠作息提醒

---

## 🚀 快速開始（3 步驟）

### 步驟 1：下載程式

1. 前往 [Releases 頁面](https://github.com/DreamOne09/radioone/releases)
2. 下載最新版本的 `radioone.exe`（約 28 MB）
3. 將檔案放到任意資料夾（例如：`C:\廣播系統\` 或隨身碟）

> ⚠️ **重要**：請確保 `radioone.exe` 和音訊檔案放在**不會被刪除**的資料夾

### 步驟 2：執行程式

直接雙擊 `radioone.exe` 即可啟動，**無需安裝任何東西**！

> 💡 如果 Windows 出現「Windows 已保護您的電腦」警告：
> 1. 點擊「更多資訊」
> 2. 點擊「仍要執行」

### 步驟 3：設定播放排程

1. 點擊「➕ 新增播放排程」按鈕
2. 在彈出視窗中：
   - 📂 點擊「選擇檔案」選擇要播放的音訊檔案（可選多個）
   - 📅 勾選要播放的星期幾（例如：週一到週五）
   - ⏰ 設定播放時間（例如：08:00）
   - ✏️ 輸入排程名稱（例如：「上課鐘聲」）
3. 點擊「送出」完成設定

完成！程式會在指定時間自動播放音訊。

---

## 📋 功能說明

### ✅ 核心功能

| 功能 | 說明 |
|------|------|
| 🎵 **定時播放** | 可設定每週固定時間自動播放音訊 |
| 📂 **多檔案支援** | 一個排程可包含多個音訊檔案，會依序播放 |
| 📅 **彈性排程** | 可設定週一到週日任意組合（例如：只在週一、三、五播放） |
| 🔔 **播放通知** | 播放時會彈出 Windows 通知，並在系統託盤閃爍 |
| 💾 **自動保存** | 所有排程設定自動保存，重開機後仍然有效 |
| 🖥️ **系統託盤** | 可最小化到系統託盤背景執行 |
| 🚀 **開機啟動** | 可設定開機時自動啟動程式 |
| 🎯 **播放佇列** | 多個排程同時觸發時會自動排隊播放 |

### 🎼 支援的音訊格式

- MP3（最常用）
- WAV
- WMA
- OGG
- FLAC
- M4A
- AAC

---

## 🖱️ 操作指南

### 新增播放排程

1. 點擊主視窗的「➕ 新增播放排程」
2. 在彈出視窗中：
   - **選擇音訊檔案**：點擊「📂 選擇檔案」按鈕，可一次選多個檔案
   - **設定播放日期**：勾選要播放的星期（可複選）
   - **設定播放時間**：使用上下箭頭或直接輸入時間
   - **輸入排程名稱**：給這個排程一個好記的名字（例如：「午休音樂」）
3. 點擊「送出」完成

> 💡 **提示**：視窗會顯示「總時長」和「預估完播時間」，方便您確認播放時間是否合適

### 編輯播放排程

- **方法 1**：雙擊排程列表中的項目
- **方法 2**：選取排程後點擊「✏️ 編輯」按鈕

### 刪除播放排程

選取排程後點擊「🗑️ 刪除」按鈕

### 測試播放

選取排程後點擊「▶️ 測試播放」，可立即播放該排程（不用等到設定時間）

### 最小化到系統託盤

- 點擊視窗的「關閉」按鈕（❌）會最小化到系統託盤（程式不會關閉）
- 在系統託盤圖示上按右鍵可以：
  - 「顯示視窗」：重新開啟主視窗
  - 「退出」：完全關閉程式

### 設定開機自動啟動

勾選主視窗底部的「開機時自動啟動」選項，程式會在電腦開機時自動執行

---

## 💻 系統需求

### 最低需求

- **作業系統**：Windows 7 / Windows Server 2008 或更新版本
- **記憶體**：512 MB RAM
- **硬碟空間**：50 MB（程式本身約 28 MB）
- **螢幕解析度**：800x600 或更高

### 建議配置

- **作業系統**：Windows 10 或 Windows 11
- **螢幕解析度**：1024x768 或更高

### ⚠️ 舊系統相容性說明

如果您在 **Windows Server 2008** 或 **Windows 7** 上執行時遇到「缺少 DLL」或「不是有效的 Win32 應用程式」錯誤：

**原因**：目前的 exe 是用 Python 3.12 打包的，不支援太舊的系統

**解決方案**：請聯繫開發者（LINE: dreamone09），我會提供專門為舊系統打包的版本（使用 Python 3.8）

---

## ❓ 常見問題

### Q1：程式沒有在設定時間播放？

**檢查項目**：
1. ✅ 確認電腦系統時間是否正確
2. ✅ 確認程式是否正在執行（檢查系統託盤是否有圖示）
3. ✅ 確認排程的「播放日期」是否包含今天
4. ✅ 確認音訊檔案路徑是否仍然存在（沒有被移動或刪除）

### Q2：播放時沒有聲音？

**檢查項目**：
1. ✅ 確認電腦音量未靜音
2. ✅ 確認喇叭或耳機已正確連接
3. ✅ 嘗試用其他播放器（如 Windows Media Player）播放同一個音訊檔案，確認檔案沒有損壞

### Q3：可以在隨身碟上使用嗎？

**可以！** 只要將 `radioone.exe` 和音訊檔案都放在隨身碟上即可。

**注意**：
- 如果隨身碟的磁碟代號改變（例如從 E: 變成 F:），需要重新設定排程
- 建議將音訊檔案和 exe 放在同一個資料夾，使用相對路徑

### Q4：可以同時執行多個程式嗎？

**不行**。程式有「單一執行實例」保護，避免多個程式同時播放造成聲音重疊。

如果嘗試開啟第二個程式，會彈出提示：「偵測到另一個自動廣播系統正在執行，請先關閉後再啟動。」

### Q5：如何完全關閉程式？

- **方法 1**：在系統託盤圖示上按右鍵 → 選擇「退出」
- **方法 2**：開啟主視窗 → 點擊底部的「退出程式」按鈕

> ⚠️ 直接點視窗的「❌」只會最小化到系統託盤，不會關閉程式

### Q6：音訊檔案可以放在網路磁碟機嗎？

**可以**，但不建議。如果網路連線中斷，程式將無法播放音訊。

建議將音訊檔案複製到本機硬碟。

### Q7：可以設定播放音量嗎？

目前程式使用系統音量播放，請直接調整 Windows 系統音量。

---

## 🛠️ 開發者資訊

### 從原始碼執行

如果您想自行修改或開發，可以從原始碼執行：

```bash
# 1. 安裝 Python 3.8 或更高版本
# 2. 安裝依賴套件
pip install -r requirements.txt

# 3. 執行程式
python main.py
```

### 自行打包

```bash
# 使用 PyInstaller 打包
pyinstaller --clean build.spec
```

打包後的 exe 位於 `dist/radioone.exe`

### 技術棧

- **Python 3.8+**（建議 3.8 以相容舊系統）
- **Tkinter** - GUI 介面
- **tkinterdnd2** - 拖放功能
- **pygame** - 音訊播放引擎
- **pystray** - 系統託盤
- **win10toast** - Windows 通知
- **Pillow** - 圖片處理
- **mutagen** - 音訊檔案資訊讀取
- **PyInstaller** - 打包工具

### 專案結構

```
RadioPotato/
├── main.py                 # 程式入口
├── build.spec              # PyInstaller 打包設定
├── requirements.txt        # Python 依賴套件
├── core/                   # 核心功能模組
│   ├── audio_utils.py      # 音訊工具
│   ├── dragdrop.py         # 拖放功能
│   ├── notifier.py         # 通知系統
│   ├── player.py           # 音訊播放器
│   ├── scheduler.py        # 排程管理
│   ├── singleton.py        # 單一執行實例
│   ├── storage.py          # 資料儲存
│   └── tray.py             # 系統託盤
├── ui/                     # 使用者介面
│   └── main_window.py      # 主視窗
└── dist/                   # 打包後的執行檔
    └── radioone.exe
```

---

## 📝 更新日誌

### v2.0.0 (2025-12-10)
- ✅ 優化介面以支援低解析度螢幕（800x600）
- ✅ 智慧型視窗大小調整（自動偵測螢幕解析度）
- ✅ 改善舊系統相容性（Windows Server 2008）
- ✅ 修正對話框在小螢幕上按鈕被遮擋的問題

### v1.0.0
- ✅ 初始版本發布
- ✅ 支援定時播放、拖放檔案、系統託盤等功能

---

## 📞 聯絡與支援

如有任何問題、建議或需要協助，歡迎聯繫：

- **LINE**：dreamone09
- **GitHub Issues**：https://github.com/DreamOne09/radioone/issues

---

## 📄 授權

本專案由李孟一老師開發，供教育及非營利用途使用。

---

## 🙏 致謝

感謝所有使用者的回饋與支援！

---

**最後更新**：2025-12-10
