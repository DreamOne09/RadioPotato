# 測試與打包指南

## 前置準備

### 1. 安裝Python（如果沒有）
- 下載並安裝 Python 3.7 或更高版本
- 確保將Python添加到系統PATH

### 2. 安裝依賴

```bash
pip install -r requirements.txt
```

如果遇到權限問題，使用：
```bash
pip install --user -r requirements.txt
```

## 測試步驟

### 1. 運行程式進行基本測試

```bash
python main.py
```

### 2. 功能測試清單

#### 介面測試
- [ ] 視窗正常打開
- [ ] 拖放區域顯示正常
- [ ] 播放計劃列表顯示正常
- [ ] 系統時間顯示正確
- [ ] 版權資訊顯示在底部

#### 檔案功能測試
- [ ] 拖放音訊檔案到視窗（或使用「選擇音訊檔案」按鈕）
- [ ] 檔案列表正確顯示
- [ ] 移除選中檔案功能正常
- [ ] 清空列表功能正常

#### 播放計劃測試
- [ ] 選擇周幾（可以多選）
- [ ] 設定播放時間（小時和分鐘）
- [ ] 輸入計劃名稱
- [ ] 添加播放計劃成功
- [ ] 播放計劃列表顯示新添加的計劃
- [ ] 測試播放功能正常
- [ ] 雙擊編輯功能正常（或點擊編輯按鈕）
- [ ] 刪除計劃功能正常

#### 播放功能測試
- [ ] 測試播放能正常播放音訊
- [ ] 播放時狀態列更新
- [ ] 播放時託盤圖示閃爍（如果支援）
- [ ] Windows通知彈出（如果支援）

#### 定時播放測試
- [ ] 設定一個接近當前時間的播放計劃（例如：當前時間15:30，設定15:31）
- [ ] 等待到設定時間，檢查是否自動播放
- [ ] 多個計劃同時觸發時，是否正確排隊

#### 資料持久化測試
- [ ] 添加播放計劃後關閉程式
- [ ] 重新打開程式，檢查播放計劃是否保留
- [ ] 檢查 `data/schedule.json` 檔案是否正確生成

#### 系統託盤測試
- [ ] 點擊視窗關閉按鈕，程式最小化到託盤
- [ ] 右鍵託盤圖示，可以顯示視窗
- [ ] 右鍵託盤圖示，可以退出程式

## 打包步驟

### 方法1：使用build.spec（推薦）

1. **確保所有依賴已安裝**
   ```bash
   pip install -r requirements.txt
   pip install pyinstaller
   ```

2. **執行打包命令**
   ```bash
   pyinstaller build.spec
   ```

3. **檢查輸出**
   - 打包後的exe位於 `dist/radioone.exe`
   - 如果打包成功，檔案大小約15-25MB

### 方法2：直接使用PyInstaller命令

```bash
pyinstaller --onefile --windowed --name=radioone --hiddenimport=pystray._win32 --hiddenimport=win32timezone --hiddenimport=tkinterdnd2 --hiddenimport=PIL._tkinter_finder --hiddenimport=win10toast main.py
```

### 打包後測試

1. **關閉開發環境中的程式**

2. **運行打包後的exe**
   - 雙擊 `dist/radioone.exe`
   - 如果首次運行較慢（解壓過程），屬正常現象

3. **功能測試**
   - 按照「功能測試清單」再次測試所有功能
   - 特別注意：
     - 檔案路徑是否正確保存
     - 播放功能是否正常
     - 系統託盤是否正常

4. **便攜性測試**
   - 將 `radioone.exe` 複製到其他目錄
   - 運行測試是否正常
   - 檢查 `data` 資料夾是否正確建立

## 常見問題

### 打包錯誤

**問題：找不到模組**
- 解決：確保所有依賴都已安裝
- 檢查 `requirements.txt` 中的所有套件

**問題：exe檔案太大**
- 解決：在build.spec中已經排除了一些大型庫
- 如果需要進一步減小，可以添加更多excludes

**問題：打包後無法運行**
- 解決：檢查是否使用了正確的Python版本
- 嘗試使用 `--debug=all` 查看詳細錯誤資訊

### 運行時錯誤

**問題：拖放功能不可用**
- 解決：這是正常的，如果tkinterdnd2未安裝會使用檔案選擇對話框

**問題：系統託盤不顯示**
- 解決：某些Windows版本可能需要額外權限，保持視窗打開即可

**問題：音訊無法播放**
- 解決：檢查檔案格式和路徑是否正確
- 確認系統音量未靜音

## 發布準備

1. **測試完整流程**
   - 從添加檔案到定時播放的完整流程測試
   - 在不同Windows版本上測試（如果可能）

2. **準備發布檔案**
   - `radioone.exe` - 主程式
   - `README.md` - 專案說明
   - `USAGE.md` - 使用說明（可選）

3. **建立發布說明**
   - 版本號
   - 功能列表
   - 已知問題
